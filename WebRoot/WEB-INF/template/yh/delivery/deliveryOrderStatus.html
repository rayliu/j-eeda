

<%layout("/yh/layout.html"){%>
<link href="/yh/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
 <link rel="stylesheet" href="/yh/css/ui/jquery-ui.css">
 <link href="/yh/js/plugins/sco/css/sco.message.css" rel="stylesheet">  
<!--link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css" rel="stylesheet"-->
        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <div class="btn-header">
                        	<!-- 配送单在途更新 -->
                    </div>
                </div>
                <!-- /.col-lg-12 -->
            </div>

            <!-- /.row -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <i class="fa fa-list fa-fw"></i>配送单在途列表
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <form role="form" style="margin: 0 15px;" id='searchForm'>
                            <div class="row search_panel">
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        <label class="search-label">配送单号</label>
                                        <input type="text" class="form-control search-control orderNo_filter" id="deliveryNo_filter" value="">
                                    </div>
                                    <div class="form-group">
                                        <div id="datetimepicker" class="input-append date "> 
                                            <label class="search-label">单据创建时间</label> 
                                            <input id="beginTime_filter" class="form-control search-control  beginTime_filter" type="text">
                                            <span class="add-on">  
                                                <i class="fa fa-calendar" data-time-icon="icon-time" data-date-icon="icon-calendar"></i>  
                                            </span>  
                                        </div>
                                    </div> 
                                    <div class="form-group">  
                                    	<label class="search-label">配送状态</label>   
                                    	<select id="status" class="form-control search-control status" name="status">
                                    		<option value=""></option>
	                                       	<option value="onTrip">配送在途</option>
	                                        <option value="finish">已送达</option>
                                    	</select>
	                                </div>
	                                <div class="form-group">
                                        <label class="search-label">始发城市</label>
                                        <input type="text" class="form-control search-control route_from" id="route_from" value="">
                                    </div>
                                </div>
                                <!-- end of col-lg-6-->
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        <label class="search-label">运输单号</label>
                                        <input type="text" class="form-control search-control orderNo_filter" id="transferorderNo_filter">
                                    </div>
                                   <div class="form-group">                                                    
                                        <span id="datetimepicker2" class="input-append date search-control "> 
                                            <label class="search-label">结束时间</label> 
                                            <input id="endTime_filter" class="form-control search-control endTime_filter" type="text">
                                            <span class="add-on">  
                                                <i class="fa fa-calendar" data-time-icon="icon-time" data-date-icon="icon-calendar"></i>  
                                            </span>  
                                        </span>
                                    </div>
                                    <div class="form-group">
                                        <label class="search-label">序列号</label>
                                        <input type="text" class="form-control search-control serialNo_filter" id="serial_no">
                                    </div>
                                    <div class="form-group">
                                        <label class="search-label">目的城市</label>
                                        <input type="text" class="form-control search-control route_to" id="route_to" value="">
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                	<div class="form-group">
                                        <label class="search-label">客户</label>
                                        <input type="text" class="form-control search-control customer_filter" id="customer_filter" placeholder="请选择或者输入客户">
										<ul id='companyList' tabindex="-1" class="pull-right dropdown-menu default" style="top: 45%; left: 33%;"></ul>                                   
                                    </div>
                                	 <div class="form-group">
                                        <label class="search-label">供应商</label>
                                        <input type="text" class="form-control search-control sp_filter" id="sp_filter" placeholder="请选择或者输入客户">
                                    	<ul id='spList' class="pull-right dropdown-menu default dropdown-scroll" tabindex="-1" style="top: 35%; left: 2%;"></ul>
                                     </div>
                                     <div class="form-group">
                                            <label class="search-label">网点</label>
                                            <select id="deliveryOffice" name="deliveryOffice" class="form-control search-control office_filter"></select>
                                     </div>
                                     <div class="form-group">   
	                                      <%include("/yh/component/form/inputDateQueryField.html", {id:'arrive_stamp', label:'配送发车时间', value:''}){} %>
                                     </div>
                                </div>
                                <!-- end of col-lg-6-->
                            </div><!-- end of row-->
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="form-group">
                                        <button id="searchBtn" class="btn  btn-primary" type="button">查询</button>
                                        <button id="resetBtn" class="btn  btn-default" type="button">清空条件</button>
                                    </div>
                                </div>
                            </div>    
                            </form>
                            <div class="table-responsive">
                                <br/>   
                                     <div class="modal fade" id="transferOrderMilestone" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
								  <div class="modal-dialog">
								    <div class="modal-content">
								      <div class="modal-header">
								      	  新里程碑
								      </div>
								      
								      <div class="modal-body">
								      	<form id="transferOrderMilestoneForm" action="">
								      		<input id="milestoneDepartId" type="hidden" name="milestoneDepartId" />
											<div class="row">
												<div class="form-group " style="border-left-width: 0px; padding-left: 12px;">									 
		                                            <div class="col-lg-12">
		                                            	<div class="row">
		                                            		<div class="col-lg-5">
		                                            			
				                                            	<div class ="form-group">
						                                            <input id="status" class="" type="hidden"	name="status">
																	<label class="control-label" for="inputSuccess">地点</label>
						                                            <input id="location" class="form-control search-control"  type="text" name="location">
				                                            	</div>
					                                       
			                                            	</div>
			                                            	<div class="col-lg-7">
				                                            	 <div class="form-group">                                                    
							                                        <span id="datetimepickerArrival" class="input-append date search-control "> 
							                                            <label class="search-label">实际到达时间</label> 
							                                            <input id="arrival_filter" name ="arrival_filter" class="form-control search-control endTime_filter" type="text">
							                                            <span class="add-on">  
							                                                <i class="fa fa-calendar" data-time-icon="icon-time" data-date-icon="icon-calendar"></i>  
							                                            </span>  
							                                        </span>
							                                    </div>
						                                    </div>
					                                    </div>
					                                    <div class="form-group">
															<label class="control-label" for="inputSuccess">配送异常即处理情况</label> 
				                                            <textarea class="form-control" id="deliveryException" name="deliveryException" rows="2"></textarea>
		                                            	</div>
		                                            	<div class="form-group">
			                                                <label class="label-margin">完成状况</label>
		                                                	
		                                                    <label class="radio-inline">
		                                                        <input type="radio" name="complete" id="completeOK" value="yes" checked="checked">完成
		                                                    </label>
		                                                    <label class="radio-inline">
		                                                        <input type="radio" name="complete" id="completeNO" value="no">未完成
		                                                    </label>
		                                                    <textarea class="form-control" id="completeRemark" name="completeRemark" rows="2"></textarea>
			                                            </div>
		                                            	<div class="form-group">
			                                                <label class="label-margin">盖章状况</label>
		                                                    <label class="radio-inline">
		                                                        <input type="radio" name="seal" id="sealOK" value="yes" checked="checked">盖章
		                                                    </label>
		                                                    <label class="radio-inline">
		                                                        <input type="radio" name="seal" id="sealNO" value="no">未盖章
		                                                    </label>
		                                                    <textarea style="display:none" class="form-control" id="remark" name="remark" rows="2"></textarea>
			                                            </div>
		                                            	<div class="form-group">
															<label>
																 <button id="transferOrderMilestoneFormBtn" type="submit" class="btn  btn-primary">添加</button>
															</label>
														</div>
		                                            </div>
		                                            	                                           
		                                            
												</div>
											</div>
											

											<div class="table-responsive">                                        
                                            <table id ="milestone_table" class="table table-striped table-bordered table-hover" style="width: 1000px;">
                                                <thead>
                                                    <tr>
                                                        <th>状态</th>
                                                        <th>地点</th>
                                                        <th>更新用户</th>
                                                        <th>更新时间</th>
                                                        <th>实际到货时间</th>
                                                        <th>完成情况</th>
                                                        <th>客户不安装原因</th>
                                                        <th>签收单盖章</th>
                                                        <th>无盖章原因</th>
                                                        <th>配送异常及处理情况</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="transferOrderMilestoneTbody" >
                                                </tbody>
                                            </table>
                                            
                                        </div>
										</form>
									      </div>
									      <div class="modal-footer">
									        <button type="button" class="btn  btn-primary" data-dismiss="modal">返回</button>
									       
									      </div>
										
								    </div><!-- /.modal-content -->
								  </div><!-- /.modal-dialog -->
								</div><!-- /.modal -->
                                <table class="table table-striped table-bordered table-hover" id="eeda-table" style="width: 1400px;">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>配送单号</th>
                                            <th>状态</th>
                                            <th>网点</th>
                                            <th>客户</th>
                                            <th>单品序列号</th>
                                            <th>型号</th>
                                            <th>件数</th>
                                            <th>始发城市</th>
                                            <th>目的城市</th>
                                            <th>供应商</th>
                                            <th>创建时间</th>
                                            <th>运输计划时间</th>
                                            <th>运输单</th>
                                            
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                    </tbody>
                                </table>
                            </div>
                            
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-12 -->
            </div>
          
        </div>
       

<%}%>
<script src="/yh/js/plugins/dataTables/jquery.dataTables.js"></script>
<script src="/yh/js/plugins/dataTables/dataTables.bootstrap.js"></script>

<script src="/yh/js/plugins/dataTables/jquery.dataTables.editable.js" type="text/javascript"></script>
<script src="/yh/js/plugins/dataTables/jquery.jeditable.js" type="text/javascript"></script>


<!-- 引入校验的js 文件及其 中文 文件-->
<script src="/yh/js/jquery.validate.min.js"></script>
<script src="/yh/js/jvalidate.messages_cn.js"></script>

<script src="/yh/js/bootstrap-datetimepicker.min.js"></script>
<script src="/yh/js/bootstrap-datetimepicker.zh-CN.js"></script>
<script src="/yh/css/ui/jquery-ui.js"></script>
<script src="/yh/js/plugins/sco/js/sco.message.js"></script>
<script>
	<%
		var deliverUpdate = shiro.hasPermission("DeliveryOder.update");
		var deliverComplete = shiro.hasPermission("DeliveryOder.completed");
		var deliverOntrip = shiro.hasPermission("DeliveryOderMilestone.completed");
	%>
	var Delivery={};
	var DeliveryOnTrip={};
	Delivery.isUpdate = ${deliverUpdate};
	Delivery.isComplete = ${deliverComplete};
	DeliveryOnTrip.isComplete = ${deliverOntrip};
</script>
<script src="/yh/js/delivery/milestone.js"></script>