<%layout("/yh/layout.html"){%>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
        <div id="page-wrapper">
            <div class="row">
           
                <div class="col-lg-12">
                    <h1 class="page-header">发车单</h1>                  
                    <input type="hidden" id="departOrderId" value="${departOrder.id!''}">
                    <input type="hidden" id="departOrderStatus" value="${departOrder.status!''}">
                    <input type="hidden" id="departOrderArrivalMode" value="${transferOrderAttr.arrival_mode!''}">
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        
                        <!-- /.panel-heading -->
                        <div class="panel-body" id="total">
                  
                            <!-- Nav tabs -->
                            <ul class="nav nav-tabs">
                                <li class="active"><a href="#basic" data-toggle="tab">基本信息</a>
                                </li>
                                <li class=""><a href="#cargos" data-toggle="tab" id="departOrderItemList">货品信息</a>
                                </li>
                                  <li class=""><a href="#milestone" data-toggle="tab" id="transferOrderMilestoneList">里程碑</a>
                                </li>
                                <li class=""><a href="#arap" data-toggle="tab">应付</a>
                                </li>
                            </ul>
                            <!-- Tab panes -->
                            <div class="tab-content">
                                <div class="tab-pane fade active in" id="basic">
                                <div class="row">
                                   <form id="orderForm" method="post" action="">
                                      <div class="col-lg-6">
                                          <input class="" id="last_detail_size" value="${last_detail_size!''}" type="hidden">
            	                            <input class="" id="depart_id" value="${departOrder.id!''}" type="hidden" name="depart_id" >
            	                            <input class="" id="type" value="${type!''}" type="hidden" >
                    	            				<input class="" id="message" value="${localArr!''}" type="hidden" name="orderid" >
                    	            				<input class="" id="tr_itemid_list" value="${tr_itemid!''}" type="hidden" name="tr_itemid_list">
                    	            				<input class="" id="item_detail" value="${item_detail!''}" type="hidden" name="item_detail" >
            	                            <input class="" id="sp_id" value="${departOrder.sp_id!''}" type="hidden" name="sp_id" > 
            	                            <input class="" id="partySpId" value="${partySp.id!''}" type="hidden" name="partySpId" > 
            	                            <input class="" id="check_sh" value="${check_sh!''}" type="hidden" name="" >
            	                            <input type="hidden" name="order_no" value="${order_no!''}${departOrder.depart_no!''}"/>
                                         	<input type="hidden" name="status" value="${status!''}${departOrder.status!''}"/>
                                         	<input type="hidden" name="create_by" value="${create_by!''}${departOrder.create_by!''}"/>
          	                              <input id="carinfoId" type="hidden" name="carinfoId" value="${departOrder.carinfo_id!''}"/> 
          	                       		    <input id="driver_id" type="hidden" name="driver_id" value="${departOrder.driver_id!''}"/>
                                          <input id="checkedDetail" type="hidden" name="checkedDetail"/>                                    	
          		                            <input id="uncheckedDetail" type="hidden" name="uncheckedDetail"/>
          		                            <input type="hidden" name="routeSp" value="${routeSp!''}"/>
                                   		   
                                          <% var chargeType=departOrder.charge_type!'';%>
	                                        <div class="form-group">
                                                 <label><h3>计费方式</h3></label>
                                                  <label class="radio-inline">
                                                    <input type="radio" name="chargeType" id="chargeType1" value="perUnit" <% if(chargeType=='perUnit'||chargeType==''){%>checked<%}%> >计件
                                                </label>
                                                <label class="radio-inline">
                                                    <input type="radio" name="chargeType" id="chargeType2" value="perCar" <% if(chargeType=='perCar'){%>checked<%}%> >整车
                                                </label>  
                                                <label class="radio-inline">
                                                    <input type="radio" name="chargeType" id="chargeType3" value="perCargo" <% if(chargeType=='perCargo'){%>checked<%}%> >零担
                                                </label> 
                                          </div>
                                          <% var ltlPriceType=departOrder.ltl_price_type!'';%>
                                          <div class="form-group" id="ltl_price_type" <% if(chargeType!='perCargo'){%>style="display: none;"<%}%> >
                                              <lable>零担计费方式:  </lable>
                                              <label class="radio-inline">
                                                  <input type="radio" name="ltlUnitType" id="optionsRadiosIn1" value="perCBM" <% if(ltlPriceType=='perCBM'||ltlPriceType==''){%>checked<%}%>>按体积（每立方米）
                                              </label>
                                               <label class="radio-inline">
                                                  <input type="radio" name="ltlUnitType" id="optionsRadiosIn3" value="perKg" <% if(ltlPriceType=='perKg'){%>checked<%}%>>按重量（每公斤）
                                              </label>
                                              <label class="radio-inline">
                                                  <input type="radio" name="ltlUnitType" id="optionsRadiosIn2" value="perTon" <% if(ltlPriceType=='perTon'){%>checked<%}%>>按重量（每吨）
                                              </label>
                                          </div>
                                   		    <div class="form-group">
                                               <h2>供应商信息</h2>
                                               <input type="text" value="${spContact.company_name!''}" name="spMessage" placeholder="选择供应商" class="form-control" id="spMessage">
                                               <ul style="top: 35%; left: 2%;" tabindex="-1" class="pull-right dropdown-menu default dropdown-scroll" id="spList"></ul>   										
                                           </div>
                                           <div class="form-group">     
                                           	   <h5 id="pageSpName">${spContact.contact_person!''} ${spContact.phone!''}</h5><h5 id="pageSpAddress">${spContact.address!''}</h5>     
                                           </div>                                                
                                               
                                        <h2>车辆信息</h2>
                                        <div class="form-group">
                                            <label>车牌</label>
                                             <div class="form-group">											
										        <input type="text" name="car_no" class="form-control" id="carNoMessage" value="${carinfo.car_no!''}">
										        <ul style="top: 17%; left: 2%;" tabindex="-1" class="pull-right dropdown-menu default" id="carNoList">
												</ul>
										    </div>
                                        </div> 
                                        <div class="form-group">
											<label>司机</label>
										    <div class="form-group">														    								
										        <input type="hidden" id="carInfoDriverMessage" value="${carinfo.driver!''}">										
										        <input type="text" name="driver_name" class="form-control" id="driverMessage" value="${driverContact.contact_person!''}">
										        <ul style="top: 17%; left: 2%;" tabindex="-1" class="pull-right dropdown-menu default" id="driverList">
												</ul>
										    </div>
									    </div>
									                                     
                                        <div class="form-group">
                                        <label>电话</label>
                                        <input id="carInfoDriverPhone" value="${carinfo.phone!''}" type="hidden">
                                        <input class="form-control" id="driver_phone" value="${driverContact.phone!''}"  name="driver_phone">
                                        </div> 
                                        <!-- <div class="form-group">
	                                        <div style=display:inline-block;width:49%>
	                                            <label>车型</label>
	                                         	<input type="hidden" value="${carinfo.cartype!''}" id="carTypeSelect">
	                                            <select name="car_type" id="cartype" class="form-control">
                                                           <option ></option>
                                                           <option value="平板车">平板车</option>
                                                           <option value="高栏车">高栏车</option>
                                                           <option value="集装车">集装车</option>
                                                           <option value="单桥车">单桥车</option>
                                                           <option value="双桥车">双桥车</option>
                                                           <option value="半挂车">半挂车</option>
                                                           <option value="冷藏车">冷藏车</option>
                                                           <option value="特种车">特种车</option>
                                                           <option value="商品运输车">商品运输车</option>
                                                           <option value="危险品车">危险品车</option>
                                                           <option value="挂车">挂车</option>
                                                           <option value="爬梯车">爬梯车</option>
                                                           <option value="可拼车">可拼车</option>
                                                           <option value="低栏车">低栏车</option>
                                                           <option value="半挂一拖二">半挂一拖二</option>
                                                           <option value="半挂一拖三">半挂一拖三</option>
                                                           <option value="半挂二拖二">半挂二拖二</option>
                                                           <option value="半挂二拖三">半挂二拖三</option>
                                                           <option value="前四后四">前四后四</option>
                                                           <option value="前四后六">前四后六</option>
                                                           <option value="前四后八">前四后八</option>
                                                           <option value="前四后十">前四后十</option>
                                                           <option value="五轮车">五轮车</option>
                                                           <option value="后八轮">后八轮</option>
                                                           <option value="半封闭">半封闭</option>
                                                           <option value="封闭车">封闭车</option>
                                                           <option value="罐式车">罐式车</option>
                                                           <option value="厢式车">厢式车</option>
                                                           <option value="自卸车">自卸车</option>
                                                           <option value="棉被车">棉被车</option>
                                                           <option value="其他">其他</option>
                                                    </select>
                                                 </div>
	                                       <div style=display:inline-block;width:50%>			                                                               
	                                            <label>车辆长度</label>
	                                         	<input type="hidden" value="${carinfo.length!''}" id="carSizeSelect">
	                                            <select name="car_size" id="carsize" class="form-control">
                                                    <option value="0"></option>
                                                    <option value="21">21.0</option>
                                                    <option value="18.5">18.5</option>
                                                    <option value="18.0">18.0</option>
                                                    <option value="17.8">17.8</option>
                                                    <option value="17.5">17.5</option>
                                                    <option value="17.0">17.0</option>
                                                    <option value="16.0">16.0</option>
                                                    <option value="15.0">15.0</option>
                                                    <option value="14.5">14.5</option>
                                                    <option value="13.5">13.5</option>
                                                    <option value="13.0">13.0</option>
                                                    <option value="12.5">12.5</option>
                                                    <option value="9.6">9.6</option>
                                                    <option value="8.6">8.6</option>
                                                    <option value="8.0">8.0</option>
                                                    <option value="7.6">7.6</option>
                                                    <option value="7.2">7.2</option>
                                                    <option value="6.8">6.8</option>
                                                    <option value="6.5">6.5</option>
                                                    <option value="5.3">5.3</option>
                                                    <option value="4.3">4.3</option>                                                
	                                            </select>
	                                       </div>
	                                       </div> -->
                                         <div class="form-group">
	                                            <label>跟车人</label>
	                                            <input class="form-control" id="car_follow_name" value="${departOrder.car_follow_name!''}" name="car_follow_name">
                                            </div>
                                                                               
                                            <div class="form-group">
	                                            <label>跟车人电话</label>
	                                            <input class="form-control" id="car_follow_phone" value="${departOrder.car_follow_phone!''}" name="car_follow_phone">
                                            </div>
                                            
                                           	<div class="form-group">
                                            <label>备注</label>
                                            <textarea class="form-control" rows="4" id="remark" name="remark" style=" height: 108px">${departOrder.remark!''}</textarea>
                                        </div> 
                                    </div>
                                      <div class="col-lg-6">
                                      <h2>发车信息</h2>  
                                         <div class="form-group">
	                                        <label>拼车单号</label> <strong>${order_no!''} ${departOrder.depart_no!''}</strong>
	                                        </div>
	                                        <div class="form-group">
	                                            <label>单据状态</label>   ${status!''} ${departOrder.status!''}
	                                        </div>
	                                        <div class="form-group">
	                                        <label>创建人</label>   ${userLogin.user_name!''}   ${userLogin2.user_name!''}                                         
	                                        </div>                                                            
									
                                          <div class="form-group">
                                         <label>始发城市</label>
                                          <div class="form-control" style="padding: 0px 0px;box-shadow:none;border:none;height:35px;" >
                                            <input id="locationForm" type="hidden" name="route_from" value="${locationFrom.code!''}">
                                            <input id="hideLocationFrom" type="hidden"> 
                        
                                               <label>省</label>
                                               <input id="hideProvinceFrom" type="hidden" value="${locationFrom.province!''}"/>
                                               <select id="mbProvinceFrom" class="valid" name="mbProvinceFrom" value=""></select>
                                               <label>市</label>
                                               <input id="hideCityFrom" type="hidden" value="${locationFrom.city!''}"/>
                                               <select  id="cmbCityFrom" class="valid" name="cmbCityFrom" value=""></select>
                                               <label>区(县)</label>
                                               <input id="hideDistrictFrom" type="hidden" value="${locationFrom.district!''}" style="width: 26%"/>
                                               <select  id="cmbAreaFrom" class="valid" name="cmbAreaFrom" value=""></select>
                                            	</div>
                                            </div>
        									<div class="form-group" >
                                            <input id="locationTo" type="hidden" name="route_to" value="${locationTo.code!''}">
                                           	<label>目的地城市</label>
		                                     <div class="form-control" style="padding: 0px 0px;box-shadow:none;border:none;height:35px;">
		                                        <label>省</label>
		                                        <input id="hideProvinceTo" type="hidden" value="${locationTo.province!''}"/>
		                                        <select id="mbProvinceTo" class="valid" name="mbProvinceTo" value=""></select>
		                                        <label>市</label>
		                                        <input id="hideCityTo" type="hidden" value="${locationTo.city!''}"/>
		                                        <select  id="cmbCityTo"  class="valid" name="cmbCityTo" value=""></select>
		                                        <label>区(县)</label>
		                                        <input id="hideDistrictTo" type="hidden" value="${locationTo.district!''}" />
		                                        <select  id="cmbAreaTo" class="valid" name="cmbAreaTo" value=""></select>
		                                    	</div>
		                                    </div>
		                                     <%if(notifi_check!''==true){%>
		                                    <div style="" id="contactInformation">
		                                     <h2>收货人信息</h2>
    	                                         <div class="form-group">
				                                           	 <label>收货地址 :</label>
				                                           	 <label id="notify_address" class="radio-inline"></label>    
        	                                        </div>
        	                                        <div class="form-group">
        	                                            <label>联系人:</label>
        	                                            <label id="notify_contact_person" class="radio-inline"></label>
        	                                          
        	                                        </div>
        	                                        <div class="form-group">
        	                                            <label>电话:</label>
        	                                            <label id="notify_phone" class="radio-inline"></label>
        	                                        </div>
                                            </div>
                                            <%}%>
                                </div>         
                                  </form>
                            </div>
                                </div>
                                <div class="tab-pane fade" id="cargos">
                                     <div class="panel-body" style="" id="ATMitem">
                                     <div class="table-responsive">                                        
		                                <table class="table table-striped table-bordered table-hover" id="departItem-table">                              
		                                <thead>
		                                        <tr>
		                                        	<th>客户</th> 
		                                        	<th>运输单号</th> 
		                                         	<th>型号</th> 
		                                            <th>名称</th>
		                                            <th>数量</th>                                   
		                                            <th>体积</th> 
		                                            <th>重量</th> 
		                                            <th>备注</th>                                          
		                                           <th>操作</th>
		                                        </tr>
		                                    </thead>                               
		                                    <tbody>                                                                                                   
		                                    </tbody>
		                                </table>                                
                                     </div>
                                        <!-- /.table-responsive -->
                                        <div style="display: none" id="transferOrderItemDateil">
	                                            <h3 class="page-header">单品列表</h3>
	 											<input id="item_id" value=0 type="hidden" >
	                                           <div class="table-responsive">
	                                          
	                                            <table id="detailTable" class="table table-striped table-bordered table-hover dataTable">
	                                                <thead>
	                                                    <tr role="row">
		                                                <th class="sorting"></th>
		                                                <th class="sorting">名称</th>
		                                                <th class="sorting">型号</th>
		                                                <th class="sorting_asc">序列号</th>
		                                                <th class="sorting">体积</th>
		                                                <th class="sorting">重量</th>
		                                                <th class="sorting">备注</th>	                                                  
		                                                </tr>
	                                                </thead>
	                                                </table>
	                                          </div>  
                    					</div>   
                                    </div> 
                                </div>  
                                  
                              <div id="milestone" class="tab-pane fade">
                                <div class="panel-body">
                                        <div class="modal fade" id="transferOrderMilestone" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                      								  
                      								    <div class="modal-content">
                                            <form id="transferOrderMilestoneForm" action="">
                          								      <div class="modal-header">
                          								        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                          								        <h4 class="modal-title" id="myModalLabel">新里程碑</h4>
                          								      </div>
                          								      <div class="modal-body">
                          								      	
                          								      		<input id="milestoneDepartId" type="hidden" name="milestoneDepartId" />
                                                </div>    
                          											<div class="form-group ">
                          											<label class="control-label" for="inputSuccess">状态(不填默认为"在途")</label> <input
                          												id="status" class="form-control" type="text"
                          												name="status">
                          											</div>
                          											<div class="form-group ">
                            											<label class="control-label" for="inputSuccess">地点</label> <input
                            												id="location" class="form-control" type="text"
                            												name="location">
                          											</div>
                      									      
                      									      <div class="modal-footer">
                      									        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                      									        <button id="transferOrderMilestoneFormBtn" type="button" class="btn btn-primary">保存</button>
                      									      </div>
                      										</form>
                      								    </div><!-- /.modal-content -->
                      								  
                      								  </div><!-- /.modal -->
                                        <div class="table-responsive">                                        
              			                            <button id="edit_status"  data-target="#transferOrderMilestone" data-toggle="modal" class="btn btn-primary" >
                          										  新里程碑
                          										</button>
                                                    <table class="table table-striped table-bordered table-hover">
                                                        <thead>
                                                            <tr>
                                                                <th>状态</th>
                                                                <th>地点</th>
                                                                <th>更新用户</th>
                                                                <th>更新时间</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="transferOrderMilestoneTbody"></tbody>
                                                    </table>
                                        </div>
                                        <!-- /.table-responsive -->                                   
                                    </div><!-- /.panel-body -->
                                  </div>
                                    

                                <div class="tab-pane fade" id="arap">
                                    <h2>应付</h2>
									                  <button class="btn btn-primary" id="addrow"> 添加应付</button>
                                    <div class="panel-body">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered table-hover"  id ="table_fin2">
                                                <thead>
                                                    <tr>
                                                        <th>费用条目</th>
                                                        <th>金额</th>
                                                        <th>备注</th>
                                                        <th>结算状态</th>
                                                        <th></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    
                                                </tbody>
                                                <div id="paymentItemList" style="display:none;">
	                                            	<%for(paymentItem in paymentItemList){ %>
	   														<option value='${paymentItem.ID!''}'>${paymentItem.NAME!''}</option>
	   												<%		
	   													}
	   												%>
                                            	</div>
                                            </table>
                                        </div>
                                        <!-- /.table-responsive -->
                                    </div>
                                    <!-- /.panel-body -->
                            </div>                   					
                        <!-- /.panel-body -->
                    <!-- /.panel -->
                </div>
                
                        <div class="modal fade" id="detailDialog" tabindex="-1">
							<div class="modal-dialog">
                                <div class="col-lg-4" class="col-lg-4" style="border-top-width: 0px; margin-top: 100px; width: 350px; height: 200px; margin-left: 150px;">
	                    			<div class="panel panel-default">
		                       			<div class="panel-heading">
		                            		温馨提示
		                        		</div>
		                       			<div class="panel-body">
		                            		<p>单据创建完毕,是否继续创建？</p>
		                        		</div>
		                        		<form id="detailCheckBoxForm" method="post" action="/yh/departOrder/createDepartOrder">
		                        			<input type="hidden" name="localArr" value="${localArr!''}">
			                       			<div class="panel-footer">
			                          			<button id="cancelBtn" type="button" class="btn btn-default" data-toggle="tooltip" title="" data-original-title="Default tooltip">否</button>
			                          			<button id="continueCreateBtn" type="button" class="btn btn-default" data-toggle="tooltip" title="" data-original-title="Default tooltip">是</button>
			                        		</div>                        		
		                        		</form>
	                   				</div> 
				                </div>
			                </div>      
			            </div> 
                    	<div class=".tooltip-demo">
	                        <hr/>
	                          <a style="display:none" id ="style"><i class='fa fa-check'></i></a>                            
		             		        <button id="saveDepartOrderBtn" type="button" class="btn btn-default" data-toggle="tooltip" title="" data-original-title="Default tooltip">保存</button>
                            		<button id="departureConfirmationBtn" type="button" disabled="true" class="btn btn-default " data-toggle="tooltip" title="" data-original-title="Default tooltip">发车确认</button>
                            <!-- <button id="warehousingConfirmBtn" type="button" disabled="true" class="btn btn-default" data-toggle="tooltip" title="" data-original-title="Default tooltip">入仓确认</button> 
                            <button id="receiptBtn" type="button" disabled="true" class="btn btn-default" data-toggle="tooltip" title="" data-original-title="Default tooltip">收货确认</button> -->
        		             		<a class="btn btn-default" href="/yh/departOrder">返回</a>
                        </div>
                    	<div class="form-group">
                    </div>
                        
                <!-- /.col-lg-12 -->
            </div>
            
        </div>
        <!-- /#page-wrapper -->

<%}%>
<script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
<script src="/yh/js/plugins/dataTables/jquery.dataTables.js"></script>
<script src="/yh/js/plugins/dataTables/dataTables.bootstrap.js"></script>
<script src="/yh/js/plugins/dataTables/jquery.dataTables.editable.js" type="text/javascript"></script>
<script src="/yh/js/plugins/dataTables/jquery.jeditable.js" type="text/javascript"></script>
<!-- 引入校验的js 文件及其 中文 文件-->
<script src="/yh/js/jquery.validate.min.js"></script>
<script src="/yh/js/jvalidate.messages_cn.js"></script>
<script src="/yh/js/departOrder/edit.js"></script>

