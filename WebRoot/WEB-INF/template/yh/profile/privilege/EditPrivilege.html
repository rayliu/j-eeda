<%layout("/yh/layout.html"){%>


<div id="page-wrapper">

	<div class="row">
		<div class="col-lg-12 panel-body">

			<h1 class="page-header">编辑用户对应角色</h1>

		</div>
		<!-- /.col-lg-12 -->
	</div>

	<div class="row">
		<div class="col-lg-12">
			<div class="panel panel-default">

				<div class="panel-body">

					<form id="UserRoleForm" name="form1" method="post"
						action="/yh/privilege/SaveRolePrivilege">


						<div class="col-lg-8">
							<div class="form-group">
								<label>用户名(必选)</label> <input type="text" id="userid"> <input type="text" name="uid" value="${id.id!''}"><select
									class="form-control" id="user" name="user">
								</select>
							</div>
						</div>
					

						<div class="col-lg-8">
							<label>角色(必选)</label> <input id="roleid" name="roleid">							
						
							<div class="form-group">
												
								<select class="form-control" id="role" name="role">	
								</select>
																					
							
							</div>
						</div>
						<div class="col-lg-8">
					<label>权限(必选)</label>
					<div class="panel panel-default" id="check" name="check">
						<div class="form-group" >
						<div class="panel-body" id="checkbox">
						</div>
							</div>
						</div>
						</div>
						<div class="col-lg-8">
							<button id="btn_sub" class="btn btn-default" type="submit">保存</button>
							<a class="btn btn-default" href="/yh/privilege"> 取消 </a>
						</div>
					</form>
				</div>
			</div>
		</div>

	</div>

</div>

<!-- content ends -->
<%}%>
<!-- 引入校验的js 文件及其 中文 文件-->
<script src="/eeda/js/jquery.validate.min.js"></script>
<script src="/eeda/js/jvalidate.messages_cn.js"></script>
<script>
	$(document)
			.ready(
					function() {				
				var user = $("#user");
					user.empty();
							$.get('/yh/privilege/SelectUser?select=1',{},
						function(data) {

									for ( var i = 0; i < data.length; i++) {
					user.append("<option value="+data[i].ID+" >("+ data[i].ID+ ")"+ data[i].USER_NAME+ "</option>");
																}

													}, 'json');
																			
						$("#user").change(
								function() {
									var user = $("#user").find("option:selected").text();
									
									var userid = $("#user").val();
									$('#userid').val(userid);
									
								});
						
						
						var role =$("#role");
				       	role.empty();
				       	$.get('/yh/privilege/SelectUser?select=2',{},function(data){

							for(var i = 0; i < data.length; i++)
							{
								role.append("<option  value="+data[i].ID+">("+data[i].ID+")"+data[i].ROLE_NAME+"</option>");
							}
							
						},'json');

				       	$("#role").change(
								function() {
									var role = $("#role").find("option:selected").text();
									
									var roleid = $("#role").val();
									$('#roleid').val(roleid);
									
								});	
				$.get('/yh/privilege/SelectUser?select=3',{},function(data) {
		    		
					for ( var i = 0; i < data.length; i++) {
						
						$("#checkbox").append("<label>"+data[i]+"</label>"+
						"<label><input type='checkbox' value='"+i+1+"' name='per'>*/</label>"+
						"<label><input type='checkbox' value='"+i+2+"' name='per'>查看</label>"+
						"<label><input type='checkbox' value='"+i+3+"' name='per'>增加</label>"+
						"<label><input type='checkbox' value='"+i+4+"' name='per'>修改</label>"+
						"<label><input type='checkbox' value='"+i+5+"' name='per'>删除</label><br/>");										
																									
										}

									}, 'json');	
											
						$('#UserRoleForm').validate(
								{
									rules : {
										user : {//form 中company_name为必填, 注意input 中定义的id, name都要为company_name
											required : true
										},
										check: {//form 中 name为必填
											required : true
										}
									},
									highlight : function(element) {
										$(element).closest('.form-group')
												.removeClass('has-success')
												.addClass('has-error');
									},
									success : function(element) {
										element.addClass('valid').closest(
												'.form-group').removeClass(
												'has-error').addClass(
												'has-success');
									}
								});
							
					})
</script>

