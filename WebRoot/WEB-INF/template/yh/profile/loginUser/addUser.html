<%layout("/yh/layout.html"){%>
<link href="/yh/js/plugins/sco/css/sco.message.css" rel="stylesheet">
	<div id="page-wrapper">
		<div class="row">
             <div class="col-lg-12">              	
                 <div class="panel panel-default">
                    <div class="panel-heading">
                 		   用户信息
            		    </div>
            		<div class="panel-body">
                  <div class="row-fluid">
                    <form lass="form-horizontal" id='leadsForm' name="leadsForm" action="/loginUser/saveUser" method="post">
                      <div class="col-md-6">
                        <input id="userId" name="userId" type="hidden" value="${lu.id!''}">
                        <div class="form-group ">
                         <label class="control-label">用户名(必填)</label>
                         <input id="username" name="username" type="text" class="form-control" value="${lu.user_name!''}" placeholder="请输入登录名(邮箱格式)">
                        </div>
                        <div class="form-group ">
                         <label class="control-label">密码(必填)</label>
                         <input type="password" class="form-control" id="password" name="password" value="${lu.password!''}">
                        </div>
                        <div class="form-group ">
                           <label class="control-label">再次输入密码(必填)</label>
                           <input type="password" class="form-control" id="confirm_password" name="confirm_password" value="${lu.password!''}">
                        </div>
                        <hr>
                        <div class="form-group ">
                          <label class="control-label">用户可见网点 </label>
                          <table class="table table-striped table-bordered table-hover" id="eeda-table" >
                              <thead>
                                  <tr>
                                      <th>网点  <button type="button" class="btn btn-default btn-sm">添加</button></th>
                                      <th>默认网点</th>
                                      <th></th>
                                  </tr>
                              </thead>
                              <tbody>
                                  <tr>
                                    <td>
                                      <select class="form-control">
                                        <option></option>
                                        <option selected="">北京</option>
                                        <option>上海</option>
                                        <option>广州</option>
                                      </select>
                                    </td>
                                    <td><input type="checkbox" checked="true" class="unChecked" name="roleCheck" value="1"></td>
                                    <td>删除</td>
                                  </tr>
                                  <tr>
                                    <td>
                                      <select class="form-control">
                                        <option></option>
                                        <option>北京</option>
                                        <option selected>上海</option>
                                        <option>广州</option>
                                      </select>
                                    </td>
                                    <td><input type="checkbox" class="unChecked" name="roleCheck" value="1"></td>
                                    <td>删除</td>
                                  </tr>
                              </tbody>
                          </table>
                        </div>
                        <div class="form-group ">
                          <button type="submit" class="btn btn-default">保存</button>
                          <a class="btn btn-default" href="/loginUser">返回</a>
                        </div>
                      </div><!-- col-md-6 -->

                      <div class="col-md-6">
                        <div class="form-group ">
                         <label class="control-label">中文名(必填)</label>
                         <input id="name" name="name" type="text" class="form-control" value="${lu.c_name!''}" placeholder="请输入中文名">
                        </div>
                        <div class="form-group">
                         <label class="control-label">密码提示</label>
                         <input type="text" class="form-control" id="pw_hint" name="pw_hint" value="${lu.password_hint!''}">
                        </div>
                        <div class="form-group" style="height: 59px; ">
                              
                        </div>
                        <div class="form-group ">
                                
                        </div>
                        <hr>
                        <div class="form-group ">
                          <label class="control-label">用户可见客户 </label>
                          <table class="table table-striped table-bordered table-hover" id="eeda-table" >
                              <thead>
                                  <tr>
                                      <th>客户  <button type="button" class="btn btn-default btn-sm">添加</button></th>
                                      <th></th>
                                  </tr>
                              </thead>
                              <tbody>
                                  <tr>
                                    <td><input  name="customer" type="text" class="form-control" value="广电运通" placeholder="请输入客户"></td>
                                    <td>删除</td>
                                  </tr>
                                  <tr>
                                    <td><input  name="customer" type="text" class="form-control" value="广州理想" placeholder="请输入客户"></td>
                                    <td>删除</td>
                                  </tr>
                              </tbody>
                          </table>
                        </div>
                      </div><!-- col-md-6 -->

                    </form>
                  </div><!-- row -->
            			<hr/>                       
			             	
			             
            			
            		</div>
					
							
				</div>
			</div>
		</div>
	</div>
<%}%>
<!-- 引入校验的js 文件及其 中文 文件-->
<script src="/yh/js/jquery.validate.min.js"></script>
<script src="/yh/js/jvalidate.messages_cn.js"></script>

<script>
	$(document).ready(function() {
		var name =$("#username").val();
		jQuery.validator.addMethod("stringCheck", function(value, element) {
			return this.optional(element) || ( /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/).test(value);
			}, "登陆名格式不正确(邮箱格式)");

    $('#menu_profile').addClass('active').find('ul').addClass('in');
        $('#leadsForm').validate({
            rules: {
            	username: {
                required: true,
                stringCheck:true,
                remote:{
                	url: "/register/checkUserNameExist", //后台处理程序    
                    type: "post",  //数据发送方式  
                    data:  {                     //要传递的数据   
                    	username: function() {   
                    		if($("#userId").val()==""){
                    			return $("#username").val(); 
                    		}else{
                    			if(name==$("#username").val()){
                    				return true;
                    			}else{
                    				return $("#username").val();
                    			}
                    		}
                              
                          },
                          
                          

                    }   
    
                }
			},
			chineseName:{
          	  required: true
            },
              password:{//form 中 name为必填
                required: true,
                minlength: 6
              },
              confirm_password: { 
            	  required: true, 
            	  minlength: 6, 
            	  equalTo: "#password" 
            	  } 
             },
             messages:{
            	 username:{
            		 remote:"用户名已存在"
            	 }
             },
            highlight: function(element) {
                $(element).closest('.form-group').removeClass('has-success').addClass('has-error');
            },
            success: function(element) {
                element.addClass('valid').closest('.form-group').removeClass('has-error').addClass('has-success');
            }
        });
        

	   	 // 获取所有城市
	   	 $.post('/transferOrder/searchAllOffice',function(data){
	   		 if(data.length > 0){
	   			 var officeSelect = $("#officeSelect");
	   			 officeSelect.empty();
	   			 var hideOfficeId = $("#hideOfficeId").val();
	   			 for(var i=0; i<data.length; i++){
	   				 if(i == 0){
	   					 officeSelect.append("<option ></option>");
	   				 }else{
	   					 if(data[i].ID == hideOfficeId){
	   						 officeSelect.append("<option value='"+data[i].ID+"' selected='selected'>"+data[i].OFFICE_NAME+"</option>");
	   					 }else{
	   						 officeSelect.append("<option value='"+data[i].ID+"'>"+data[i].OFFICE_NAME+"</option>");					 
	   					 }
	   				 }
	   			 }
	   		 }
	   	 },'json');
    });
</script>
