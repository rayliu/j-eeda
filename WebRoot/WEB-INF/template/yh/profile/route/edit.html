<%layout("/yh/layout.html"){%>
	<div id="page-wrapper">
		<div class="row">
			<div class="col-lg-12">
			<h1 class="page-header">
			<h1 class="page-header">
			</h1>
			</h1>
				<div class="panel panel-default">
					<div class="panel-heading">
					干线信息
				</div>
					<div class="panel-body">
						<div class="row-fluid">
							<form lass="form-horizontal" id='leadsForm' name="leadsForm" action="/yh/route/saveRoute" method="post">
								<input id="routeId" name="routeId" type="hidden" value="${ul.id!''}">
								<div class="form-group ">
									<label class="control-label">出发地点</label>
									<input id="from_id" name="from_id" type="hidden" class="form-control" value="${ul.location_from!''}">
									<input id="fromName" name="fromName" type="text" class="form-control" value="${ul.location_from!''}">
									<ul id='fromLocationList' class="pull-right dropdown-menu default" >
									</ul>
								</div>
								<div class="form-group ">
									<label class="control-label">目的地点</label>
									<input id="to_id" name="to_id" type="hidden" class="form-control" value="${ul.location_from!''}">
									<input id="toName" name="toName"  class="form-control" type="text" value="${ul.location_to!''}">
									<ul id='toLocationList' tabindex="-1" class="pull-right dropdown-menu default" style="top: 65%; left: 3%;">
									</ul>
								</div>
								<div class="form-group">
									<label class="control-label">备注</label>
									<input type="text" class="form-control" id="remark" name="remark" value="${ul.remark!''}">
								</div>
							<button type="submit" class="btn btn-default">保存</button>
							<a class="btn btn-default" href="/yh/route">取消</a>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<%}%>
<!-- 引入校验的js 文件及其 中文 文件-->
<script src="/yh/js/jquery.validate.min.js"></script>
<script src="/yh/js/jvalidate.messages_cn.js"></script>
<script>
	$(document).ready(function() {
		$('#menu_profile').addClass('active').find('ul').addClass('in');
		$('#leadsForm').validate({
			rules: {
				fromName: {
					required: true
				},
				toName:{//form 中 name为必填
				required: true
				}
			},
			highlight: function(element) {
				$(element).closest('.form-group').removeClass('has-success').addClass('has-error');
			},
			success: function(element) {
				element.addClass('valid').closest('.form-group').removeClass('has-error').addClass('has-success');
			}
		});
		//选择出发地点
		$('#fromName').on('keyup', function(){
			var inputStr = $('#fromName').val();
			$.get('/yh/route/search', {locationName:inputStr}, function(data){
				console.log(data);
				var fromLocationList =$("#fromLocationList");
				fromLocationList.empty();
				for(var i = 0; i < data.length; i++)
				{
					fromLocationList.append("<li><a tabindex='-1' class='fromLocationItem' code='"+data[i].CODE+"'>+data[i].NAME+</a></li>");
				}
			
			},'json');
			
			$("#fromLocationList").css({ 
	        	left:$(this).position().left+"px", 
	        	top:$(this).position().top+32+"px" 
	        }); 
			fromLocationList.show();
		});
		
		$('#fromLocationList').on('click', '.fromLocationItem', function(e){
			$('#from_id').val($(this).attr('code'));
			$('#fromName').val($(this).text());
        	$("#fromLocationList").hide();
    	});
		
		//选择目的地点
		$('#toName').on('keyup', function(){
			var inputStr = $('#toName').val();
			$.get('/yh/route/search', {locationName:inputStr}, function(data){
				
				var toLocationList =$("#toLocationList");
				toLocationList.empty();
				for(var i = 0; i < data.length; i++)
				{
					toLocationList.append("<li><a tabindex='-1' class='fromLocationItem' code='"+data[i].CODE+"'>"+data[i].NAME+"</a></li>");
				}
				
				toLocationList.show();
			},'json');
			$("#toLocationList").css({ 
	        	left:$(this).position().left+"px", 
	        	top:$(this).position().top+32+"px" 
	        }); 
		});
	
		$('#toLocationList').on('click', '.fromLocationItem', function(e){
			$('#to_id').val($(this).attr('code'));
			$('#toName').val($(this).text());
        	$("#toLocationList").hide();
    	});
		
});
</script>