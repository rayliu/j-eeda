<%layout("/yh/layout.html"){%>    
 <div id="wrapper">

        <div id="page-wrapper">
           
            <div class="col-lg-12">
                <h1 class="btn-header"></h1>
            </div>
            
            
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
			            	<% if(shiro.hasPermission("UserRole.create")){%>
			            		<a  class="btn  btn-primary" href="/userRole/add">分配新用户角色</a>
			            	<%}%>
			            </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover" id="table" style="width: 1235px;">
                                    <thead>
                                        <tr>
                                            <th>用户名称</th>
                                            <th>用户角色</th>
                                            <th>备注</th>  
                                            <% 
                                            	var ur_isUpdate = shiro.hasPermission("UserRole.update");
                                            	var ur_isSelect = shiro.hasPermission("UserRole.permission_list");
                                            	if(ur_isUpdate || ur_isSelect){
                                            %>                                         
                                            	<th></th>
                                            <%}%>
                                        </tr>
                                    </thead>
                                    <tbody>
                                                                                                                                            
                                    </tbody>
                                </table>
                            </div>   
                            
                        </div>
                       
                    </div>
                   
                </div>
               
            </div>
         
        </div>
        <!-- /#page-wrapper -->

    </div>
 
 <%}%>
    <!-- /#wrapper -->


    <!-- Page-Level Plugin Scripts - Tables -->
    <script src="/yh/js/plugins/dataTables/jquery.dataTables.js"></script>
    <script src="/yh/js/plugins/dataTables/dataTables.bootstrap.js"></script>
    <!-- Page-Level Demo Scripts - Tables - Use for reference -->
    <script>
    $(document).ready(function() {
      $('#menu_profile').addClass('active').find('ul').addClass('in');
   	
   	 	$('#table').dataTable( {
	   		 "bFilter" : false,
	   		 "sDom": "<'row-fluid'<'span6'l><'span6'f>r><'datatable-scroll't><'row-fluid'<'span12'i><'span12 center'p>>",
	   	        //"sPaginationType": "bootstrap",
   	        "iDisplayLength": 10,
   	    	"oLanguage": {
   	            "sUrl": "/eeda/dataTables.ch.txt"
   	        },
   	        "sAjaxSource": "/userRole/list",
   			"aoColumns": [
   	            { "mDataProp":"USER_NAME"},
   	            { "mDataProp":"NAME"},
   	            { "mDataProp":"REMARK"}
   	            <% 
   	            	var updatePermission = shiro.hasPermission("UserRole.update");
   	            	var selectPermission = shiro.hasPermission("UserRole.permission_list");
   	            	if(updatePermission || selectPermission){
   	            %>
   	            ,{ "mDataProp":null,
   	         		"sWidth": "8%", 
		   	         "fnRender": function(obj) {  
		   	        	
		   	        	  if(obj.aData.ROLE_CODE != "admin"){
		   	        	  return "<% if(updatePermission){%><nobr><a class='btn  btn-sm btn-primary' href='/userRole/edit?username="+obj.aData.USER_NAME+"'>"+
		                          "<i class='fa fa-edit fa-fw'></i> "+"编辑"+ "</a> <%}%>"+
		                      		"<% if(selectPermission){%><a class='btn  btn-sm btn-primary' href='/userRole/userPermissionRender?username="+obj.aData.USER_NAME+"'>"+
		                          "<i class='fa fa-search fa-fw'></i> "+ "查看"+ "</a></nobr><%}%>";
		   	        	 }else{
		   	        		return "<% if(selectPermission){%><a class='btn  btn-sm btn-primary' href='/userRole/userPermissionRender?username="+obj.aData.USER_NAME+"'>"+
		                            "<i class='fa fa-search fa-fw'></i> "+ "查看"+ "</a><%}%>";
		   	        	 } 
		                 
		   	         }
		   	 	}
             <%}%>
   	      	]
   		});
   		
   });
</script>
