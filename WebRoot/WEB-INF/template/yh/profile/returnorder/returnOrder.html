<%layout("/yh/layout.html"){%>

        <div id="page-wrapper">
            <div class="row">
           
                <div class="col-lg-12">
                    <h1 class="page-header">回单</h1>                  
                  
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        
                        <!-- /.panel-heading -->
                        <div class="panel-body" id="total">
                       
                         <%if(saveOK!''==true){%>  
		    <div class="alert alert-success">
              <button type="button" class="close" data-dismiss="alert">×</button>
              保存成功
            </div>
		    <%}%>
                            <!-- Nav tabs -->
                            <ul class="nav nav-tabs">
                                <li class="active"><a href="#basic" data-toggle="tab">基本信息</a>
                                </li>
                                <li class=""><a href="#cargos" data-toggle="tab">货品明细</a>
                                </li>
                                <li class=""><a href="#arap" data-toggle="tab">应收</a>
                                </li>
                            </ul>

                            <!-- Tab panes -->
                            <div class="tab-content">
                                <div class="tab-pane fade active in" id="basic">
                                <div class="row">
                               <div class="col-lg-6">
                                <input class="form-control" id="snature" value="${nature}" type="hidden" >
                                    <form role="form" method="post" action="/yh/returnorder/save">
                                     <input class="form-control" id="id" value="${id}" type="hidden" name="id">
                                    
                                   		  <h2>回单信息</h2>  
                                   		   <div class="form-group">
                                            <label>回单号</label>
                                            <label class="radio-inline" id="order_no"></label>
                                        </div>
                                         <div class="form-group">
                                            <label>状态</label>
                                            <label class="radio-inline" id="transaction_status"></label>
                                        </div>
                                         
                                         
                                        <div class="form-group">
                                            <label>回单创建人</label>
                                            <label class="radio-inline" id="creator"></label>
                                        </div>                                                                               
                                        <div class="form-group">
                                            <label>回单创建时间</label>
                                            <label class="radio-inline" id="create_date"></label>
                                        </div>
                                        
                                        <h2>客户信息</h2>  
                                         <div class="form-group">
                                            <label>公司名称</label>
                                            <label class="radio-inline" id="pay_company"></label>
                                        </div>
                                         
                                         
                                        <div class="form-group">
                                            <label>地址</label>
                                            <label class="radio-inline" id="pay_address"></label>
                                        </div>                                                                               
                                        <div class="form-group">
                                            <label>联系人</label>
                                            <label class="radio-inline" id="pay_contad"></label>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>电话</label>
                                            <label class="radio-inline" id="pay_phone"></label>
                                        </div>  
                                       
                                                                           
                                   <h2>收货人信息</h2>
                                  
                                        <div class="form-group">
                                            <label>收货人公司名称</label>
                                            <label class="radio-inline" id="company"> </label>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>收货地址</label>
                                            <label class="radio-inline" id="address"></label>
                                        </div>
                                        <div class="form-group">
                                            <label>联系人</label>
                                            <label class="radio-inline" id="contad"></label>
                                        </div>
                                        <div class="form-group">
                                            <label>电话</label>
                                            <label class="radio-inline" id="phone"> </label>
                                        </div>
                                        
                                        <div class="form-group">
                                        <button class="btn btn-default" type="submit">&nbsp&nbsp&nbsp&nbsp保存&nbsp&nbsp&nbsp&nbsp</button>
                                         
                                         </div>
                                       
                                       
                                        
                                    </form>
                                      
                                    </div>
                                    
                                <!-- /.col-lg-6 (nested) -->
                                <div class="col-lg-6">
                                   <h2>运输信息</h2>
                                    <div class="form-group">
                                        <label>运输单号</label> <strong id="transfer_order_no" class="radio-inline"></strong>
                                    </div>  
                                     <%if(check!''==true){%>  
                      					<div class="form-group">
                                        <label>配送单号</label> <strong id="DELIVERY_ORDER_ID_NO" class="radio-inline"></strong>
                                    </div> 
                       				 <%}%>
                                                                            
                                    <div class="form-group">
                                     <label >业务员</label> &nbsp;&nbsp;&nbsp;
                                        <label class="radio-inline" id="counterman"></label>                                         
                                    </div>
                                    <div class="form-group">
                                        <label>货品属性</label>
                                        <label class="radio-inline" id="nature">                                               		 
                                            </label>   
                                    </div>
                                    <div class="form-group">
                                        <label>提货方式</label>
                                            <label class="radio-inline" id="pickup">                                                	
                                            </label>                                           
                                    </div>                                        
                                        <div class="form-group">
                                            <label>到达方式</label>
                                            <label class="radio-inline" id="arrival">
                                            </label>                                          
                                        </div>                                         
                                    <h2>路线</h2>
                                   			 <div class="form-group">
                                           		<label>始发点</label>
                                           		<label  class="radio-inline" id="location_from" > </label>                                
                                       			 </div>       
                                              <div class="form-group">                                        
                                              	<label>终点</label>
                                           		<label  class="radio-inline" id="location_to" ></label>
                                 			</div>  
                                 			
                                 			<div class="form-group">
                                            <label>备注</label>
                                            <textarea class="form-control" rows="8" id="remark"></textarea>
                                        </div> 
                                      
                                </div>

                                <!-- /.col-lg-6 (nested) -->
                            </div>
                                </div>
                                <div class="tab-pane fade" id="cargos">
                                    <div class="panel-body" style="display:none" id="item">
                                        <div class="table-responsive">
                                        
                                <table class="table table-striped table-bordered table-hover" id="example">                             
                               
                                    <thead>
                                        <tr>
                                            <th>名称</th>
                                            <th>型号</th>
                                            <th>数量</th>                                   
                                            <th>货损数量</th> 
                                            <th>剩余数量</th>
                                            <th>单位</th> 
                                            <th>体积</th> 
                                            <th>重量</th> 
                                            <th>备注</th>                                          
                                           
                                        </tr>
                                    </thead>
                                    <tbody>
                                                                                                                                            
                                    </tbody>
                                </table>
                       
                                          
                                        </div>
                                        <!-- /.table-responsive -->
                                    </div>
                                    
                                     <div class="panel-body" style="display:none" id="ATMitem">
                                        <div class="table-responsive">
                                        
                                <table class="table table-striped table-bordered table-hover" id="exampl">
                              
                                <thead   >
                                        <tr>
                                         	<th>序列号</th> 
                                            <th>名称</th>
                                            <th>数量</th>                                   
                                            <th>体积</th> 
                                            <th>重量</th> 
                                            <th>备注</th>                                          
                                           
                                        </tr>
                                    </thead>                               
                                    <tbody>
                                                                                                                                            
                                    </tbody>
                                </table>
                       
                                          
                                        </div>
                                        <!-- /.table-responsive -->
                                    </div>
                                  
                                    <!-- /.panel-body -->
                                </div>
                              
                                <div class="tab-pane fade" id="arap">
                                    <h2>应收</h2>
                                    <div class="panel-body">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>#</th>
                                                        <th>费用条目</th>
                                                        <th>金额</th>
                                                        <th>备注</th>
                                                        <th>结算状态</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="pay">
                                                                                                      
                                                </tbody>
                                            </table>
                                        </div>
                                        <!-- /.table-responsive -->
                                    </div>
                                    <!-- /.panel-body -->
                                    
                                  
                             
                                    <!-- /.panel-body -->
                                </div>
                                
                                
                             
                            </div>
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-12 -->

            </div>
        </div>
        <!-- /#page-wrapper -->

<%}%>
<script src="/yh/js/plugins/dataTables/jquery.dataTables.js"></script>
 <script src="/yh/js/plugins/dataTables/dataTables.bootstrap.js"></script>
  <script src="/yh/js/jquery.validate.min.js"></script>
<script src="/yh/js/jvalidate.messages_cn.js"></script>
<script>
    $(document).ready(function() {
        $('#menu_return').addClass('active').find('ul').addClass('in');
        
        var inputStr = $('#id').val(); 
        
       
     
           
    	$.get('/yh/returnorder/checkorder', {locationName:inputStr}, function(data){   		
			for(var i=0; i < data.length; i++){
				nature=data[i].NATURE;
				$('#transfer_order_no').html(data[i].TRANSFER_ORDER_NO);
				$('#DELIVERY_ORDER_ID_NO').html(data[i].DELIVERY_ORDER_ID_NO);
				$('#nature').html(data[i].NATURE);
	        	$('#pickup').html(data[i].PICKUP);
	        	$('#arrival').html(data[i].ARRIVAL);	        	
	        	$('#remark').val(data[i].REMARK); 
	        	$('#location_from').html(data[i].LOCATION_FROM);
	        	$('#location_to').html(data[i].LOCATION_TO);
	        	$('#amount').val(data[i].AMOUNT);
	        	$('#amount2').html(data[i].AMOUNT);
	        	$('#company').html(data[i].COMPANY_NAME);
	        	$('#phone').html(data[i].PHONE);
	        	$('#contad').html(data[i].CONTACT);
	        	$('#address').html(data[i].ADDRESS);
	        	$('#pay_company').html(data[i].PAY_COMPANY);
	        	$('#pay_phone').html(data[i].PAY_PHONE);
	        	$('#pay_contad').html(data[i].PAY_CONTAD);
	        	$('#pay_address').html(data[i].PAY_ADDRESS);
	        	$('#order_no').html(data[i].ORDER_NO);
	        	$('#creator').html(data[i].CREATOR);
	        	$('#create_date').html(data[i].CREATE_DATE);
	        	$('#transaction_status').html(data[i].TRANSACTION_STATUS);
	        	$('#counterman').html(data[i].COUNTERMAN);
	        	$('#lastcreator').html(data[i].COUNTERMAN);
				
			}
			
		
	},'json');
   
    	/**
    	
    	$.get('/yh/returnorder/itemlist', {locationName:inputStr}, function(data){ 
    		for(var i=0; i < data.length; i++){	
    			if(data[i].ITEM_NAME=="ATM"){
    				
    				$("#ATMitem").append(" <thead>"
    	  					+"<tr>"
      						 +"<th>序列号</th>"
     						 +"<th>名称</th>"
      						 +"<th>数量</th>"
     						 +"<th>货损数量</th>"
     						 +"<th>剩余数量</th>"     					
    						 +"<th>体积</th>" 
     						 +"<th>重量</th>"
     						 +"<th>收货人/地址/电话</th>"
     						+"<th>货损？</th>"
     						+"<th>货损信息</th>"
     						 +"<th>备注</th>"
   						 +"</tr>"
   						+"</thead>"
                            +"<tbody>"   
                            +"<tr><td>"+data[i].SERIAL_NO+"</td>"
    		    			+"<td>"+data[i].ITEM_NAME+"</td>"
    		    			+"<td>"+data[i].AMOUNT+"</td>"
    		    			+"<td>"+data[i].LASTTOTAL+"</td>"
    		    			+"<td>"+data[i].LASTAMOUNT+"</td>"	
    		    			+"<td>"+data[i].VOLUME+"</td>"
    		    			+"<td>"+data[i].WEIGHT+"</td>"
    		    			+"<td>"+data[i].CONTACT+"</br>"+data[i].PHONE+"</br>"+data[i].ADDRESS+"</td>"
    		    			+"<td>"+data[i].IS_DAMAGE+"</td>"
    		    			+"<td>"+data[i].ESTIMATE_DAMAGE_AMOUNT+"</td>"
    		    			+"<td>"+data[i].REMARK+"</td></tr>"
                            +" </tbody>");
    				 
    			}else{
    				$("#style").show();
    				$("#item").show();
    				$("#item").append("<tr><td>"+data[i].ITEM_NAME+"</td>"
    		    			+"<td>"+data[i].ITEM_NO+"</td>"
    		    			+"<td>"+data[i].AMOUNT+"</td>"
    		    			+"<td>"+data[i].LASTTOTAL+"</td>"
    		    			+"<td>"+data[i].LASTAMOUNT+"</td>"
    		    			+"<td>"+data[i].UNIT+"</td>"
    		    			+"<td>"+data[i].VOLUME+"</td>"
    		    			+"<td>"+data[i].WEIGHT+"</td>"
    		    			+"<td>"+data[i].ITEM_DESC+"</td></tr>");
    			}
    			
    		}
    	},'json');
    	**/
    	$.get('/yh/returnorder/paylist', {locationName:inputStr}, function(data){ 
    		for(var i=0; i < data.length; i++){
    			
    			$("#pay").append(" <tr><td>"+i+"</td>"
    			+"<td>"+data[i].NAME+"</td>"
    			+"<td>"+data[i].AMOUNT+"</td>"
    			+"<td>"+data[i].REMARK+"</td>"
    			+"<td>"+data[i].STATUS+"</td></tr>");
    		}
    	},'json');
    	 var nature = $('#snature').val(); 
  
    	
    		
    	 if(nature=="ATM"){
    		 $("#ATMitem").show();
    		 $('#exampl').dataTable( {
           		 "sDom": "<'row-fluid'<'span6'l><'span6'f>r>t<'row-fluid'<'span12'i><'span12 center'p>>",
           	        //"sPaginationType": "bootstrap",insert into return_order(status_code,create_date,order_type,creator,remark,transfer_order,distribution_order_id,contract_id
           	        "iDisplayLength": 10,
           	    	"oLanguage": {
           	            "sUrl": "/eeda/dataTables.ch.txt"
           	        },
           	        "sAjaxSource": "/yh/returnorder/itemlist?locationName="+inputStr+"",
           	       
           			"aoColumns": [
           			          
           				{ "mDataProp": "SERIAL_NO" },
           				{ "mDataProp": "ITEM_NAME" },
           				{ "mDataProp": "AMOUNT" },
           	            { "mDataProp": "VOLUME" },
           	            { "mDataProp": "WEIGHT" },
           	            { "mDataProp": "REMARK" },
           	         
           	            
           	            ]
           	       
           	});
    	 }else{
    		$("#item").show();
    		 $('#example').dataTable( {
           		 "sDom": "<'row-fluid'<'span6'l><'span6'f>r>t<'row-fluid'<'span12'i><'span12 center'p>>",
           	        //"sPaginationType": "bootstrap",insert into return_order(status_code,create_date,order_type,creator,remark,transfer_order,distribution_order_id,contract_id
           	        "iDisplayLength": 10,
           	    	"oLanguage": {
           	            "sUrl": "/eeda/dataTables.ch.txt"
           	        },
           	        "sAjaxSource": "/yh/returnorder/itemlist?locationName="+inputStr+"",
           	       
           			"aoColumns": [

           				{ "mDataProp": "ITEM_NAME" },
           				{ "mDataProp": "ITEM_NO" },
           				{ "mDataProp": "AMOUNT" },
           	            { "mDataProp": "LASTTOTAL" },
           	            { "mDataProp": "LASTAMOUNT" },
           	            { "mDataProp": "UNIT" },
           	         	{ "mDataProp": "VOLUME" },
           	         	{ "mDataProp": "WEIGHT" },
        	            { "mDataProp": "ITEM_DESC" },
           	            
           	            ]
           	       
           	});
    	}
    		    	
    	
         		
    
   
    });
</script>