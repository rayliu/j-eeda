package controllers.yh;import java.util.List;import java.util.HashMap;import java.util.Map;import models.UserLogin;import models.eeda.Leads;import com.jfinal.core.Controller;import com.jfinal.log.Logger;import com.jfinal.plugin.activerecord.Db;import com.jfinal.plugin.activerecord.Record;public class LocationController extends Controller {	private Logger logger = Logger.getLogger(LocationController.class);	// in config route已经将路径默认设置为/yh	// me.add("/yh", controllers.yh.AppController.class, "/yh");	public void index() {		render("/yh/profile/location.html");	}	//列出城市信息	public void listLocation(){		 		String sLimit = "";		String pageIndex = getPara("sEcho");		if (getPara("iDisplayStart") != null && getPara("iDisplayLength") != null) {			sLimit = " LIMIT " + getPara("iDisplayStart") + ", " + getPara("iDisplayLength");		}				//获取总条数		String totalWhere="";		String sql = "select count(1) total from user_login ";		Record rec = Db.findFirst(sql + totalWhere);		logger.debug("total records:" + rec.getLong("total"));				//获取当前页的数据		List<Record> orders = Db.find("select (select name from location pl where pl.code= l.pcode) as p_name,code,name,pcode from location l");		//List<Record> orders = Db.find("select CONCAT(l.name,'',l1.name,'',l3.name),l.code,l.pcode,l1.code,l1.pcode from location l left join location l1 on l.code=l1.pcode inner join location l3 on l3.pcode=l1.code");		Map orderMap = new HashMap();		orderMap.put("sEcho", pageIndex);		orderMap.put("iTotalRecords", rec.getLong("total"));		orderMap.put("iTotalDisplayRecords", rec.getLong("total"));		orderMap.put("aaData", orders);				renderJson(orderMap);	}}